{% extends "registration/base.html" %}

{% block content %}

    <form method="post" action="{% url 'login' %}">
        {% csrf_token %}
        <div class="row justify-content-center">
            <div class="form-floating">
                {% if next or form.errors %}
                    <div class="row">
                        <div class="col-auto">
                            <div class="alert alert-danger py-2">
                                {% if next %}
                                    {% if user.is_authenticated %}
                                        <p class="my-1">
                                            <i class="fas fa-exclamation-circle"></i>
                                            Your account doesn't have access to this page.
                                            To proceed, please login with an account that has access.
                                        </p>
                                    {% else %}
                                        <p class="my-1">
                                            <i class="fas fa-exclamation-circle"></i>
                                            Please login to see this page.
                                        </p>
                                    {% endif %}
                                {% endif %}
                                {% if form.errors %}
                                    <p class="my-1">
                                        <i class="fas fa-exclamation-circle"></i>
                                        Your username and password didn't match. Please try again.
                                    </p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endif %}
                <h3 class="mb-3">FDM Expenses Portal Staff Login</h3>
                <div class="form-floating mb-3">
                    {{ form.username }}
                    <!-- CSS left property is overwritten to correct a positioning issue -->
                    <label for="{{ form.username.id_for_label }}" style="left: auto">Username</label>
                </div>
                <div class="form-floating mb-3">
                    {{ form.password }}
                    <!-- CSS left property is overwritten to correct a positioning issue -->
                    <label for="{{ form.password.id_for_label }}" style="left: auto">Password</label>
                </div>
                <div class="row justify-content-between">
                    <div class="col-12 col-sm-auto">
                        <a class="btn btn-secondary" href="{% url 'password_reset' %}">Forgotten password?</a>
                    </div>
                    <div class="col-12 col-sm-auto mt-2 mt-sm-0">
                        <input class="btn btn-primary px-4" type="submit" value="Login">
                    </div>
                </div>
            </div>
        </div>
        <input type="hidden" name="next" value="{{ next }}">
    </form>

{% endblock %}

{% block scripts %}

    <script>
        // Manual override of the 'username' form field to implement Bootstrap formatting
        description_input_element = document.getElementById("{{ form.username.id_for_label }}");
        description_input_element.classList.add("form-control");
        description_input_element.placeholder = "Username";

        // Manual override of the 'password' form field to implement Bootstrap formatting
        description_input_element = document.getElementById("{{ form.password.id_for_label }}");
        description_input_element.classList.add("form-control");
        description_input_element.placeholder = "Password";
    </script>

{% endblock %}